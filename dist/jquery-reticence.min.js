/*! jQuery-Reticence Plugin v0.3.0 | github.com/kawamanza/jquery-reticence/ */
(function(f){var q,r,s,t,h,g,n;q=/^\s*<\/?([^\s>]+).*$/m;t=function(a){var b,c,d;d={ancestor:a};a.parents().each(function(){var a,b;b=f(this);a="hidden"===b.css("overflow")?"container":"ancestor";d[a]=b;return"ancestor"===a});if(d.container){if(c=d.container.children(),b=d.ancestor,1!==c.length||b===a)b=f('<div style="height: auto;">'),c.appendTo(b),b.appendTo(d.container),d.ancestor=b}else throw"Could not find container with 'overflow: hidden' style";return d};n=function(a){return a&&a.replace(q,
"$1")};g=function(a){var b,c,d,e,f,k,h,g,l,p,m;e=a.data("reticence");m=e.scan;c=e.ancestor;f=e.container;g=m.length-1;for(e=[];;){if(k){for(;!(b=m[g--],(h=b.indexOf("<")+1)&&("/"!==b.charAt(1)&&e.length&&-1!==e[0].indexOf("</")&&n(b)===n(e[0])?e.shift():e.unshift(b)),l-=b.length,k=k.substr(0,l),-1===g||!h););a.html(k+"..."+e.join(""));p||(p=!0,f.addClass("reticent"))}else k=m.join(""),l=k.length,p=!1,f.removeClass("reticent"),a.html(k),d=f.height();b=c.height();if(b<=d||-1===g)break}};s=function(a){var b,
c;c=null;b=function(){g(a);c=null};a.data("reticence").container.resize(function(){c&&clearTimeout(c);c=setTimeout(b,30)})};r=function(a,b){var c,d;a=f(a);if(c=a.data("reticence"))return g(a);c=t(a);d=h.matchers[b.reduceMode||"char"];c.text=a.html();c.scan=c.text.match(d);a.data("reticence",c);g(a);b.resizable&&s(a)};h=function(a){a=f.extend({},a);return this.each(function(){r(this,a)})};h.matchers={"char":/\s*(?:<.*?>|[^\s<])/gm,word:/\s*(?:<.*?>|[^\s<]+)/gm};f.fn.reticence=h})(jQuery);
