/*! jQuery-Reticence Plugin v0.3.0 | github.com/kawamanza/jquery-reticence/ */
(function(g){var m,n,p,q,r,h,k,l;m=/^\s*<\/?([^\s>]+).*$/m;r=function(b){var a,c,d;d={ancestor:b};b.parents().each(function(){var a,b;b=g(this);a="hidden"===b.css("overflow")?"container":"ancestor";d[a]=b;return"ancestor"===a});if(d.container){if(c=d.container.children(),a=d.ancestor,1!==c.length||a===b)a=g('<div style="height: auto;">'),c.appendTo(a),a.appendTo(d.container),d.ancestor=a}else throw"Could not find container with 'overflow: hidden' style";return d};l=function(b){return b&&b.replace(m,
"$1")};q=function(b,a,c){var d,e,f,g;g=a.scan;for(e=a.captures;!(d=g[a.last--],(f=d.indexOf("<")+1)&&("/"!==d.charAt(1)&&e.length&&-1!==e[0].indexOf("</")&&l(d)===l(e[0])?e.shift():e.unshift(d)),a.len-=d.length,c=c.substr(0,a.len),-1===a.last||!f););b.html(c+"..."+e.join(""));a.reticent||(a.reticent=!0,a.container.addClass("reticent"))};k=function(b){var a,c,d,e,f;a=b.data("reticence");c=a.ancestor;for(f={scan:a.scan,container:a.container,last:a.scan.length-1,captures:[]};!(e?q(b,f,e):(e=f.scan.join(""),
f.len=e.length,f.reticent=!1,f.container.removeClass("reticent"),b.html(e),d=f.container.height()),a=c.height(),a<=d||-1===f.last););};p=function(b){var a,c;c=null;a=function(){k(b);c=null};b.data("reticence").container.resize(function(){c&&clearTimeout(c);c=setTimeout(a,30)})};n=function(b,a){var c,d;b=g(b);if(c=b.data("reticence"))return k(b);c=r(b);d=h.matchers[a.reduceMode||"char"];c.text=b.html();c.scan=c.text.match(d);b.data("reticence",c);k(b);a.resizable&&p(b)};h=function(b){b=g.extend({},
b);return this.each(function(){n(this,b)})};h.matchers={"char":/\s*(?:<.*?>|[^\s<])/gm,word:/\s*(?:<.*?>|[^\s<]+)/gm};g.fn.reticence=h})(jQuery);
